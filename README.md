# BERT4REC

### Запуск тренировки
Для того, чтобы запустить код тренировки, нужно прописать следующую команду:

```bash
python3 train.py
```

Опционально, можно изменить некоторые аргументы:

```bash
python3 train.py model.seed=123
```

Обратите внимание, если вы хотите логгировать все в mlflow, необходимо поднять его через docker compose:

```python3
sudo docker compose up -d --build
```

### Запуск инференса
Для запуска инференса необходимо:
1. Указать путь до логгера, пример: logger_to_path=./logs/inference_bert4rec.log
2. Указать путь до конфига. Данный конфиг автоматически сохраняется в папку outputs
3. Указать путь до модели. Веса модели храняются в папке weights
4. Указаться device. 

Все это можно сделать через CLI:
```bash
python3 inference.py log.log ./outputs/2024-05-07/08-53-25/.hydra/config.yaml ./weights/bert4rec_large_data/epoch=09-val_loss=5.5002.ckpt cuda:0
```

### Описание проекта

- conf: папка для конфигурационных файлов Hydra.
- data: папка для хранения рекомендаций и истории пользователя.
- docker: папка, содержащая конфигурации для запуска MLflow с помощью Docker.
- logs: папка для логов, связанных с тренировкой и инференсом модели.
- notebooks: папка с Jupyter ноутбуками.
- outputs: папка, где находятся логи Hydra.
- scripts: папка со скриптами на Python. Основные скрипты: data_inference.py, data.py, model.py
- ui: папка с интерфейсом, написанным на Gradio, для оценки рекомендаций.
- weights: папка для хранения весов модели.
- inference.py: скрипт для инференса модели.
- train.py: скрипт для тренировки модели.

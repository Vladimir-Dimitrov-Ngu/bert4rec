[2024-05-08 21:12:28,229][scripts.utils][INFO] - 


 ### TRAIN NEW INSTANCE MODEL ###
[2024-05-08 21:12:28,232][scripts.utils][INFO] - Call get statistics method
[2024-05-08 21:12:28,232][scripts.utils][INFO] - Read data from path: /data/vdimitrov/transformer/data/history_2024-04-15_2024-04-22.csv in get_statistics
[2024-05-08 21:12:36,313][scripts.utils][INFO] - PREPROCESSING DATA
[2024-05-08 21:12:36,314][scripts.utils][INFO] - Border datetime 2024-04-21
[2024-05-08 21:15:03,313][scripts.utils][INFO] - Cast data
[2024-05-08 21:15:33,985][scripts.utils][INFO] - Number in observation with watch time greater than 0: 166626235
[2024-05-08 21:17:53,891][scripts.utils][INFO] - Number unique users: 66392565
[2024-05-08 21:17:54,042][scripts.utils][INFO] - Users with 5 or more interactions 5282648
[2024-05-08 21:18:38,309][scripts.utils][INFO] - Number on observation in train with users did 5 or more interactions 88951452
[2024-05-08 21:21:06,171][scripts.utils][INFO] - Train len: 60237261
[2024-05-08 21:21:22,156][scripts.utils][INFO] - Val history: 34606770
[2024-05-08 21:21:34,083][scripts.utils][INFO] - Val labels: 2116666
[2024-05-08 21:22:04,422][scripts.utils][INFO] - Number users in train 5022687
[2024-05-08 21:22:04,480][scripts.utils][INFO] - Number users in train after filter (min_sequence_len: 5): 3524516
[2024-05-08 21:22:18,368][scripts.utils][INFO] - Number of items: 2219031
[2024-05-08 21:22:18,517][scripts.utils][INFO] - Number of items after filtering (min items count: 5): 2219031
[2024-05-08 21:22:54,488][scripts.utils][INFO] - Save train data
[2024-05-08 21:23:02,501][scripts.utils][INFO] - Save val data
[2024-05-08 21:23:29,090][scripts.utils][INFO] - Len train_dataset: 3491426
[2024-05-08 21:23:29,090][scripts.utils][INFO] - Len test_dataset: 1787978
[2024-05-08 21:23:29,090][scripts.utils][INFO] - All time for preprocessing: 652.78
[2024-05-08 21:23:36,354][scripts.utils][INFO] - Len item2id 327620
[2024-05-08 21:23:36,354][scripts.utils][INFO] - Len train dataloader 27276
[2024-05-08 21:23:37,591][scripts.utils][INFO] - init weights for model
[2024-05-08 21:23:37,593][scripts.utils][INFO] - (tensor([     2,  87296, 251722, 262821, 251722, 321090], dtype=torch.int32), tensor([245553,   -100,   -100,   -100,   -100,   -100]))
[2024-05-08 21:23:41,400][scripts.utils][INFO] - SETUP DATA
